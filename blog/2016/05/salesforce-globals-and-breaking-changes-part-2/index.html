<!DOCTYPE html><html><head><title>Salesforce: Globals and Breaking Changes, Part 2 | Jeff Hube</title><meta name=viewport content="width=device-width"><link rel=alternate type=application/rss+xml title="Jeff Hube &raquo; Feed" href=/blog/feed.xml><link rel=icon type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/stylesheets/style.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300" rel=stylesheet type=text/css></head><body><div class=rows><div class=row><div class=header><div class=container><label for=hamburger class=hamburger-label></label><a class=title href=/ >Jeff Hube</a></div></div><input type=checkbox id=hamburger class=hamburger-input checked><div class=nav><div class="container container-collapse"><a href=/games/ >Games</a><a href=/demos/ >Demos</a><a href=/resume/ >Resume</a><a href=/ class=active>Blog</a></div></div></div><div class="row row-expand"><div class=content><div class="container clearfix"><div class=column-wrapper><div class="column column-right"><div class=column-inner><div><h1>Salesforce: Globals and Breaking Changes, Part 2</h1><span class=post-date>May 10, 2016</span><p>In <a href=/blog/2016/04/salesforce-globals-and-breaking-changes-part-1/ >my last post</a> we examined a scenario where replacing an implicit constructor with an explicit one was a breaking change. Now we&#39;ll look at a similar issue where overriding a virtual method can be a breaking change.</p><p>This time we&#39;ll create two global classes in our managed package, where the first contains a virtual method and the second extends the first.</p><pre><code class="hljs apex"><span class=hljs-keyword>global</span> <span class=hljs-keyword>virtual</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>ExampleClass</span> </span>{
    <span class=hljs-function><span class=hljs-keyword>global</span> <span class=hljs-keyword>virtual</span> <span class=hljs-keyword>void</span> <span class=hljs-title>foo</span><span class=hljs-params>()</span> </span>{ }
}

<span class=hljs-keyword>global</span> <span class=hljs-keyword>virtual</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>ExampleChildClass</span> <span class=hljs-keyword>extends</span> <span class=hljs-title>ExampleClass</span> </span>{
}</code></pre><p>Once again, we&#39;ll imagine that these have been packaged into version 1.0 of a managed package with a prefix of <code>TEST</code>, and this package has been installed into the subscriber org. In the subscriber org, we extend the second class from our managed package and override the virtual method that it inherits from the first.</p><pre><code class="hljs apex"><span class=hljs-keyword>global</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>ExampleGrandchildClass</span> <span class=hljs-keyword>extends</span> <span class=hljs-title>TEST</span>.<span class=hljs-title>ExampleChildClass</span> </span>{
    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>override</span> <span class=hljs-keyword>void</span> <span class=hljs-title>foo</span><span class=hljs-params>()</span> </span>{ }
}</code></pre><p>Back in our managed package, we determine that <code>ExampleChildClass</code> actually needs to override the behavior of our virtual method.</p><pre><code class="hljs apex"><span class=hljs-keyword>global</span> <span class=hljs-keyword>virtual</span> <span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>ExampleChildClass</span> <span class=hljs-keyword>extends</span> <span class=hljs-title>ExampleClass</span> </span>{
    <span class=hljs-comment>// added this line:</span>
    <span class=hljs-function><span class=hljs-keyword>global</span> <span class=hljs-keyword>override</span> <span class=hljs-keyword>virtual</span> <span class=hljs-keyword>void</span> <span class=hljs-title>foo</span><span class=hljs-params>()</span> </span>{ }
}</code></pre><p>Now we release version 1.1 of our managed package with this change, and install it into the subscriber org. Since our new override is virtual, we expect that the class we created earlier is still valid.</p><pre><code>ExampleGrandchildClass: line #, column #: ExampleGrandchildClass: Method does not override an ancestor method: void foo()
</code></pre><p>The class in our subscriber org fails to compile because it cannot see the override that we created in version 1.1 of our package. Like last time, this error can be resolved by going to the Version Settings tab and changing the class to reference version 1.1.</p><p>What options do we have if we don&#39;t want to break the subscriber classes in the first place?</p><h3 id=1-override-global-virtual-methods-on-every-subclass-at-the-time-of-creation>1. Override global virtual methods on every subclass at the time of creation</h3><p>This option is far from ideal, especially if you have a lot of virtual methods or a large class hierarchy, and unfortunately does not help if you have existing virtual methods.</p><h3 id=2-wait-for-the-fix>2. Wait for the fix</h3><p>This issue was acknowledged last week, and you can find the known issue <a href="https://success.salesforce.com/issues_view?id=a1p3A000000IXXqQAO">here</a> if you wish to follow it for status updates.</p><p>Have you encountered any other changes that can unexpectedly break consuming code? Let me know in the comments.</p><p>Cheers,</p><p>Jeff</p><div class=tags><a class=tag href=/blog/tags/salesforce/ >Salesforce</a></div><div class=next-prev><span class=next-prev-secondary>Previous Post</span> <a href=/blog/2016/04/salesforce-globals-and-breaking-changes-part-1/ >Salesforce: Globals and Breaking Changes, Part 1</a></div><div class=next-prev><span class=next-prev-secondary>Next Post</span> <a href=/blog/2016/07/fixing-metadata-wsdl/ >Fixing metadata.wsdl</a></div><div id=disqus_thread></div><script type=text/javascript>var disqus_config = function() {
    this.page.identifier = '/blog/2016/05/salesforce-globals-and-breaking-changes-part-2/'
    this.page.title = 'Salesforce: Globals and Breaking Changes, Part 2';
    this.page.url = 'http://www.jeffhube.com' + location.pathname;
};
(function(){var d=document,s=d.createElement('script');s.src='//jeffhube.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script></div></div></div></div><div class="column column-left"><div class=column-inner><h3>Recent Posts</h3><div class=recent-post><a href=/blog/2016/07/fixing-metadata-wsdl/ >Fixing metadata.wsdl</a> <span class=recent-post-date>July 05, 2016</span></div><div class=recent-post><a href=/blog/2016/05/salesforce-globals-and-breaking-changes-part-2/ >Salesforce: Globals and Breaking Changes, Part 2</a> <span class=recent-post-date>May 10, 2016</span></div><div class=recent-post><a href=/blog/2016/04/salesforce-globals-and-breaking-changes-part-1/ >Salesforce: Globals and Breaking Changes, Part 1</a> <span class=recent-post-date>April 27, 2016</span></div><div class=recent-post><a href=/blog/2016/04/welcome/ >Welcome!</a> <span class=recent-post-date>April 25, 2016</span></div><h3>Tags</h3><div class=popular-tag><a href=/blog/tags/salesforce/ >Salesforce</a> <span class=tag-count>(3)</span></div><div class=popular-tag><a href=/blog/tags/welcome/ >welcome</a> <span class=tag-count>(1)</span></div></div></div></div></div></div><div class=row><div class=footer><div class=container><div class=social><a href=http://www.youtube.com/user/jrh2365/videos><img src=/images/social/32_youtube.png width=32 height=32 alt=YouTube></a><a href=http://www.linkedin.com/in/jeffhube><img src=/images/social/32_linkedin.png width=32 height=32 alt=LinkedIn></a></div><div class=copyright>Copyright &copy; Jeff Hube 2016</div></div></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-20753646-2','auto');ga('send','pageview');</script></body></html>