<!DOCTYPE html><html><head><title>Salesforce: Globals and Breaking Changes, Part 1 | Jeff Hube</title><meta name=viewport content="width=device-width"><link rel=alternate type=application/rss+xml title="Jeff Hube &raquo; Feed" href=/blog/feed.xml><link rel=icon type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/stylesheets/style.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300" rel=stylesheet type=text/css></head><body><div class=rows><div class=row><div class=header><div class=container><label for=hamburger class=hamburger-label></label><a class=title href=/ >Jeff Hube</a></div></div><input type=checkbox id=hamburger class=hamburger-input checked><div class=nav><div class="container container-collapse"><a href=/games/ >Games</a><a href=/demos/ >Demos</a><a href=/resume/ >Resume</a><a href=/ class=active>Blog</a></div></div></div><div class="row row-expand"><div class=content><div class="container clearfix"><div class=column-wrapper><div class="column column-right"><div class=column-inner><div><h1>Salesforce: Globals and Breaking Changes, Part 1</h1><span class=post-date>April 27, 2016</span><p>Salesforce has a number of rules regarding what changes can be made to global classes, interfaces, and methods once they have been released in a managed package, in order to prevent future package versions from breaking customers&#39; code. Let&#39;s examine a couple scenarios where Salesforce falls short of this goal.</p><p>Here&#39;s a sampling of the rules surrounding globals that have been released in a managed package:</p><ul><li>The method signature (return type, parameters) of a global method cannot be changed</li><li>The visibility of a global class or method cannot be reduced</li><li>Methods cannot be added to or removed from global interfaces</li><li>Abstract methods cannot be added to a global class</li><li>You cannot change a global class to no longer implement a global interface it previously implemented</li></ul><p>Now, imagine we create a managed package containing the following class.</p><pre><code>global class MyPackagedClass {
}
</code></pre><p>It doesn&#39;t do much, but since it does not have a constructor explicitly defined, an implicit default constructor will be provided, as in Java. Let&#39;s package this class up in version 1.0 of a managed package with a prefix of <code>TEST</code>, and install it into another Salesforce organization which I will call the subscriber org. In the subscriber org, we will create a class that consumes our packaged class.</p><pre><code>public with sharing class MySubscriberClass {
    private TEST.MyPackagedClass c = new TEST.MyPackagedClass();
}
</code></pre><p>All set. Now, in the future we determine that we need to execute some logic whenever an instance of <code>MyPackagedClass</code> is created. So we add a constructor, and release version 1.1 of our package.</p><pre><code>global class MyPackagedClass {
    global MyPackagedClass() {
        // do something here
    }
}
</code></pre><p>Since we are simply replacing the implicit global constructor with an explicitly defined global constructor, the code we wrote in the subscriber org should still work fine after we install the new version, right?</p><pre><code>MySubscriberClass: line #, column #: Package Visibility: Constructor is not visible: [TEST.MyPackagedClass].&lt;Constructor&gt;()
</code></pre><p>Oh no, now it fails to compile! To fix it, we need to open <code>MySubscriberClass</code>, go to the Version Settings tab, and change it to reference version 1.1 of the TEST package. Why does this happen? My best guess is that Salesforce only looks at the explicitly defined constructor and sees that it was introduced in version 1.1 while our class was referencing 1.0. It does not realize that version 1.0 contained an implicit constructor, and so compilation fails until you change the class to referencing version 1.1.</p><p>Now, we&#39;ve fixed the problem, but it would be better to never have broken our customers&#39; code in the first place. So what options do we have?</p><h3 id=1-don-t-add-constructors-to-global-classes-that-were-released-with-no-explicit-constructor>1. Don&#39;t add constructors to global classes that were released with no explicit constructor</h3><p>This is a given, but I&#39;ll list it anyway. If you just need to initialize some member variables, maybe you can do so inline with the variable declaration.</p><h3 id=2-don-t-make-any-classes-global-without-a-constructor>2. Don&#39;t make any classes global without a constructor</h3><p>As long as you avoid the implicit global constructor, you&#39;re safe. You could define an empty global constructor and fill it in later, or start with a private / public constructor and introduce a global one afterwards, if needed.</p><h3 id=3-wait-for-salesforce-to-fix-it>3. Wait for Salesforce to fix it</h3><p>I reported this issue to Salesforce and they acknowledged back in November of 2015. You can follow the <a href="https://success.salesforce.com/issues_view?id=a1p30000000jbNHAAY">known issue</a> to receive status updates.</p><p>That&#39;s all for now. Stay tuned for <a href=/blog/2016/05/salesforce-globals-and-breaking-changes-part-2/ >part 2</a>, where we&#39;ll examine an even trickier case.</p><p>Cheers,</p><p>Jeff</p><div class=tags><a class=tag href=/blog/tags/salesforce/ >Salesforce</a></div><div class=next-prev><span class=next-prev-secondary>Previous Post</span> <a href=/blog/2016/04/welcome/ >Welcome!</a></div><div class=next-prev><span class=next-prev-secondary>Next Post</span> <a href=/blog/2016/05/salesforce-globals-and-breaking-changes-part-2/ >Salesforce: Globals and Breaking Changes, Part 2</a></div><div id=disqus_thread></div><script type=text/javascript>var disqus_config = function() {
    this.page.identifier = '/blog/2016/04/salesforce-globals-and-breaking-changes-part-1/'
    this.page.title = 'Salesforce: Globals and Breaking Changes, Part 1';
    this.page.url = 'http://www.jeffhube.com' + location.pathname;
};
(function(){var d=document,s=d.createElement('script');s.src='//jeffhube.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script></div></div></div></div><div class="column column-left"><div class=column-inner><h3>Recent Posts</h3><div class=recent-post><a href=/blog/2016/07/fixing-metadata-wsdl/ >Fixing metadata.wsdl</a> <span class=recent-post-date>July 05, 2016</span></div><div class=recent-post><a href=/blog/2016/05/salesforce-globals-and-breaking-changes-part-2/ >Salesforce: Globals and Breaking Changes, Part 2</a> <span class=recent-post-date>May 10, 2016</span></div><div class=recent-post><a href=/blog/2016/04/salesforce-globals-and-breaking-changes-part-1/ >Salesforce: Globals and Breaking Changes, Part 1</a> <span class=recent-post-date>April 27, 2016</span></div><div class=recent-post><a href=/blog/2016/04/welcome/ >Welcome!</a> <span class=recent-post-date>April 25, 2016</span></div><h3>Tags</h3><div class=popular-tag><a href=/blog/tags/salesforce/ >Salesforce</a> <span class=tag-count>(3)</span></div><div class=popular-tag><a href=/blog/tags/welcome/ >welcome</a> <span class=tag-count>(1)</span></div></div></div></div></div></div><div class=row><div class=footer><div class=container><div class=social><a href=http://www.youtube.com/user/jrh2365/videos><img src=/images/social/32_youtube.png width=32 height=32 alt=YouTube></a><a href=http://www.linkedin.com/in/jeffhube><img src=/images/social/32_linkedin.png width=32 height=32 alt=LinkedIn></a></div><div class=copyright>Copyright &copy; Jeff Hube 2016</div></div></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-20753646-2','auto');ga('send','pageview');</script></body></html>